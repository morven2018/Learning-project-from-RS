(()=>{"use strict";var e={d:(t,o)=>{for(var s in o)e.o(o,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:o[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function o(e,t){const o=Array(t).fill([]);for(let s=0;s<t;s+=1)o[s]=Array.from(e[s].split(""));return o}function s(e,t=document.querySelector("body")){const s=e.size,c=o(e.template,s);console.log(1,c);const d=document.createElement("div");d.className="field",t.append(d);const i=document.createElement("div");i.className="field-extra",d.append(i);const m=document.createElement("div");i.append(m);const p=document.createElement("div");p.className="field__attempt",i.append(p),p.setAttribute("style",`grid-template-columns: repeat(${s}, 20px);`);const u=document.createElement("div");u.className="field__additional",d.append(u);const b=document.createElement("div");b.className="field__attempt",u.append(b),b.setAttribute("style",`grid-template-rows: repeat(${s},  21px);`);const _=document.createElement("div");_.className="game-field",u.append(_),_.setAttribute("style",`grid-template-columns: repeat(${s},  20px);`);const g=a(c,s,!0),f=a(c,s,!1),y=l(f);m.setAttribute("style",`min-width: ${20*y+5*(y-1)}px`),r(g,p,!0),r(f,b,!1),console.log(2,g),console.log(3,f),function(e,t,o){for(let s=0;s<t;s+=1)for(let a=0;a<t;a+=1){const l=document.createElement("div");e[s][a],l.classList.add("game-field__cell"),l.classList.add("game-field__cell_unknown"),o.append(l),n(s,a,l,t)}}(c,s,_)}function a(e,t,o=!0){const s=Array(t);if(o)for(let o=0;o<t;o+=1){let a=[],n=0;for(let s=0;s<t;s+=1)"1"===e[s][o]?(n+=1,s+1===t&&a.push(n)):(n>0&&a.push(n),n=0);s[o]=a}else for(let o=0;o<t;o+=1){let a=[],n=0;for(let s=0;s<t;s+=1)"1"===e[o][s]?(n+=1,s+1===t&&a.push(n)):(n>0&&a.push(n),n=0);s[o]=a}return s}function n(e,t,o,s){t%5==0&&0!=t&&o.setAttribute("style","border-left: none"),e%5==0&&0!=e&&o.setAttribute("style","border-top: none"),e%5!=4&&e!==s-1||o.setAttribute("style","border-bottom: 2px solid black"),t%5==4&&(o.setAttribute("style","border-right: 2px solid black"),e===s-1&&o.setAttribute("style","border-bottom: 2px solid black;  border-right: 2px solid black")),t===s-1&&(o.setAttribute("style","border-right: 2px solid black"),e===s-1&&o.setAttribute("style","border-bottom: 2px solid black;  border-right: 2px solid black"),e%5==4&&e!=s-1&&o.setAttribute("style","border-bottom: 2px solid black;  border-right: 2px solid black"),e%5==0&&0!=e&&o.setAttribute("style","border-top: none;  border-right: 2px solid black")),0===t&&(o.setAttribute("style","border-left: 2px solid black"),e%5==0&&0!==e&&o.setAttribute("style","border-top: none; border-left: 2px solid black"),e%5==4&&0!=e&&o.setAttribute("style","border-bottom: 2px solid black; border-left: 2px solid black "),e===s-1&&o.setAttribute("style","border-bottom: 2px solid black;  border-left: 2px solid black;")),0===e&&(o.setAttribute("style","border-top: 2px solid black"),0===t&&o.setAttribute("style","border-top: 2px solid black; border-left: 2px solid black; "),t===s-1&&o.setAttribute("style","border-top: 2px solid black; border-right: 2px solid black; "),0!==t&&t%5==0&&o.setAttribute("style","border-top: 2px solid black;  border-left: none"),t!==s-1&&t%5==4&&o.setAttribute("style","border-top: 2px solid black;  border-right: 2px solid black")),e===s-1&&t%5==0&&0!=t&&o.setAttribute("style","border-left: none;  border-bottom: 2px solid black"),e%5==4&&t%5==4&&e!==s-1&&t!==s-1&&o.setAttribute("style","border-bottom: 2px solid black;  border-right: 2px solid black"),t%5==0&&e%5==0&&0!==e&&0!==t&&o.setAttribute("style","border-left: none; border-top:none"),t%5==0&&e%5==4&&e!=s-1&&0!=t&&o.setAttribute("style","border-left: none;  border-bottom: 2px solid black"),t%5==4&&e%5==0&&0!==e&&t!==s-1&&o.setAttribute("style","border-top: none; border-right: 2px solid black")}function l(e){let t=0;return e.forEach((e=>t=t<e.length?e.length:t)),t}function r(e,t,o=!0){const s=o?"field__attempt__top-attempt":"field__attempt__left-attempt",a=o?"field__attempt__top-attempt__cell":"field__attempt__left-attempt__cell",n=l(e),r=o?`height: ${20*n+5*(n-1)}px`:`width: ${20*n+5*(n-1)}px`;e.forEach(((n,l)=>{const c=document.createElement("div");if(c.className=s,t.append(c),c.setAttribute("style",r),0===l&&o&&c.setAttribute("style","border-left: 2px solid black;"),0!==l||o||c.setAttribute("style","border-top: 2px solid black"),o&&l%5==4&&c.setAttribute("style","border-right: 2px solid black;"),o&&l%5==0&&0!=l&&c.setAttribute("style","border-left: none"),o||l%5!=0||0==l||c.setAttribute("style","border-top: none; padding-top: 4px;"),o&&l+1===e.length&&c.setAttribute("style","border-right: 2px solid black;"),o||l%5!=4||c.setAttribute("style","border-bottom: 2px solid black;"),l+1!==e.length||o||c.setAttribute("style"," border-bottom: 2px solid black;"),n.length)n.forEach((e=>{const t=document.createElement("div");t.className=a,t.textContent=e,c.append(t)}));else{const e=document.createElement("div");e.className=a,e.textContent="0",c.append(e)}}))}function c(e){const s=(0,t.getTemplates)()[2].template,a=d(e),n=o(s,e);return a.every(((e,t)=>e.every(((e,o)=>"-1"===e||e===n[t][o]))))}function d(e){const t=document.querySelectorAll(".game-field__cell"),o=Array(e);for(let s=0;s<e;s+=1){o[s]=[];for(let a=0;a<e;a+=1)t[s*e+a].classList.contains("game-field__cell_checked")&&o[s].push("1"),t[s*e+a].classList.contains("game-field__cell_crossed")&&o[s].push("0"),t[s*e+a].classList.contains("game-field__cell_unknown")&&o[s].push("-1")}return o}function i(e=null){if(e)localStorage.setItem("level",e);else{const e=document.querySelector(".nonograms-list__tabs__active");localStorage.setItem("level",e.value)}}function m(e,t,o,s=!1,a=null){const n=document.createElement("button");n.className=t,n.textContent=o,s?e.prepend(n):e.append(n),a&&(n.value=a)}e.r(t),e.d(t,{B:()=>o,h:()=>s});const p={Easy:5,Medium:10,Hard:15};let u="Easy";const b=document.querySelector("body");let _;function g(e){console.log("clear"),["game-field__cell_unknown","game-field__cell_checked","game-field__cell_crossed"].forEach((t=>{e.classList.contains(t)&&e.classList.remove(t)}))}window.onload=function(e,t="Easy"){b.classList.add("start-page"),console.log("1"),fetch("../dist/materials/data/nonogramm.json").then((e=>e.json())).then((e=>{_=e,void 0===localStorage.level?console.log("wtf"):i("Easy"),function(e){const t=document.querySelector("body");let o=Object.keys(localStorage).includes("level")?localStorage.getItem("level"):"Easy";const s=document.createElement("h1");s.className="game-header",s.textContent="Nonograms",t.append(s);const a=document.createElement("div");a.className="start-page-buttons",t.append(a),m(a,"start-page-buttons__random-game","Random game"),m(a,"start-page-buttons__continue-last-game","Continue last game");const n=document.createElement("main");n.classList="main",t.append(n);const l=document.createElement("div");l.classList="nonograms-list",n.append(l);const r=document.createElement("div");r.className="nonograms-list__tabs",l.append(r),function(e,t="Easy"){Object.keys(p).forEach((o=>{const s=document.createElement("div");s.textContent=`${o} (${p[o]}x${p[o]})`;let a=`nonograms-list__tabs__${o.toLowerCase()}`;s.classList.add(a),s.value=o,e.append(s),t===o&&s.classList.add("nonograms-list__tabs__active")}))}(r);const c=document.createElement("div");c.className="nonograms-list__cards",l.append(c),e.filter((e=>e.size===p[o])).forEach((e=>function(e,t){const o=document.createElement("div");o.className="card",e.append(o),t.id,o.classList.add("card_done"),e.append(o);const s=document.createElement("h3");s.className="card__header",s.textContent=t.name,o.append(s);const a=document.createElement("div");a.className="cards__content",o.append(a);const n=document.createElement("div");n.className="card__preview",s.append(n);const l=document.createElement("div");l.className="card__info",a.append(l);const r=document.createElement("p");r.classList="card__timer";let c=(t.id,t.id,"00:00");r.textContent=`Time: ${c}`,l.append(r),t.id,m(l,"start-page-buttons__another-try","Play again?",!1,t.id),console.log(t.id),m(l,"start-page-buttons__continue-game","Continue"),t.id}(c,e)));const d=document.createElement("div");d.className="nonograms-list__records",n.append(d),function(e){const t=localStorage.getItem("nonograms"),o=document.createElement("h2");if(o.classList="nonograms-list__records__header",e.append(o),o.textContent="Records:",t){const o=JSON.parse(t);(o.length>5?o.slice(-5,-1):o).forEach(((t,o)=>{const s=document.createElement("div");s.className="nonograms-list__records__item",e.append(s);const a=document.createElement("div");a.className="records__item__position",e.append(a),a.textContent=o;const n=document.createElement("div");n.className="records__item__info",e.append(n);const l=document.createElement("h3");l.className="records__item__name",n.append(l),l.textContent=t.name;const r=document.createElement("h3");r.className="records__item__time",n.append(r),r.textContent=t.time;const c=document.createElement("h3");c.className="records__item__size",n.append(c),c.textContent=`${t.size}x${t.size}`}))}else{const t=document.createElement("div");t.className="nonograms-list__records__none",e.append(t),t.textContent="There is no records at time."}}(d)}(_)}))},b.addEventListener("click",(e=>{"game-field__cell"===e.target.classList[0]&&(e.target.classList.contains("game-field__cell_checked")?(g(e.target),e.target.classList.add("game-field__cell_unknown")):(g(e.target),e.target.classList.add("game-field__cell_checked")),c(p[u])&&function(e){const s=(0,t.getTemplates)()[2].template,a=d(e),n=o(s,e);return a.every(((e,t)=>e.every(((e,o)=>"0"===("-1"===e&&n[t][o])||e===n[t][o]))))}(p[u])?console.log("You win!"):c(p[u])||console.log("Make error")),"start-page-buttons__another-try"!==e.target.classList[0]&&"start-page-buttons__new-game"!==e.target.classList[0]||(console.log(_,e.target.value,_[e.target.value-1]),i(),function(){const e=document.querySelector(".main");e&&e.remove();const t=document.querySelector(".start-page-buttons");t&&t.remove()}(),function(e){const t=document.querySelector("body"),o=document.createElement("h1");o.className="game-header__name",o.textContent=e.name,t.append(o);const a=document.createElement("div");a.className="game-area",t.append(a),s(e,a);const n=document.createElement("div");n.className="game-header__data",a.append(n);const l=document.createElement("div");l.className="game-timer",l.classList.add("game-timer__inactive"),l.textContent="Timer: 00:00:00",n.append(l);const r=document.createElement("div");r.className="bth-list",n.append(r),m(r,"start-page-buttons__save-game","Save game"),m(r,"start-page-buttons__reset-game","Reset"),m(r,"start-page-buttons__game-solution","Solution")}(_[e.target.value-1]))})),b.addEventListener("contextmenu",(e=>{"game-field__cell"===e.target.classList[0]&&(e.target.classList.contains("game-field__cell_crossed")?(g(e.target),e.target.classList.add("game-field__cell_unknown")):(g(e.target),e.target.classList.add("game-field__cell_crossed")),c(p[u])||console.log("Make error cross"),e.preventDefault())}))})();